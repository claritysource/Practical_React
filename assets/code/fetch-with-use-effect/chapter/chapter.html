<html xmlns='http://www.w3.org/1999/xhtml' xmlns:dk='http://www.kirsanov.com'>
  <head>
    <title>Fetch with the useEffect() hook</title>  
    <meta http-equiv='content-type' content='text/html; charset=UTF-8'/>  
    <link rel='stylesheet' type='text/css' href='./css/book.css'/>  
  </head>  
  <body style='counter-reset: h1 2'> 
    <h1 class='basic'>Fetch with <code>useEffect()</code></h1> 
      <p>This exercise involves...</p>

    <h2>Rationale</h2>
      <p></p>

    <h2>Expectations</h2>
      <p></p>

    <h2>Level of Difficulty</h2>
      <p>4 out of 10</p>

    <h2 id='concepts'>Concepts</h2> 
      <p></p>
    <h2 id='exercise-description'>The Exercise Description</h2> 
      <p></p>
    <p>The starting point for the Fetch with <code>useEffect()</code>exercise is shown in the following figure.</p>
    <img src="./images/start.png" width="974" height="774"/>
      
      <pre id='sec1-1'>
1  import React from 'react';
2  import './App.css';
3  
4  const App = () =&gt; {
5    const URL = 'https://www.googleapis.com/books/v1/volumes?q=';
6  
7    return (
8      &lt;div&gt;
9        &lt;form&gt;
10         &lt;label htmlFor='query-input'&gt;Search For &lt;/label&gt;
11         &lt;input
12           id='query-input'
13           type='text'
14         /&gt;
15       &lt;/form&gt;
16 
17       &lt;div style={{marginTop: '20px'}}&gt;
18         Show the list of books here
19       &lt;/div&gt;
20     &lt;/div&gt;
21   )
22 }
23 
24 export default App;
</pre>

<p></p>

    <h2 id='start'>The Solution</h2> 
      <img src="./images/solution-1.png" width="974" height="774"/>
      <p>...</p>
    <p></p>

      <img src="./images/solution-2.png" width="974" height="774"/>
      <p>...</p>
    <p></p>

      <img src="./images/solution-3.png" width="974" height="774"/>
      <p>...</p>
      <pre id='sec1-1'>
1  import React, {useRef, useState, useEffect} from 'react';
2  import './App.css';
3  
4  const Solution = React.memo(() =&gt; {
5    const URL = 'https://www.googleapis.com/books/v1/volumes?q='
6    const inputRef = useRef();
7    const [query, setQuery] = useState('')
8    const [url, setUrl] = useState('')
9    const [items, setItems] = useState([])
10   const [loading, setLoading] = useState(false)
11   const [error, setError] = useState('')
12 
13   useEffect(() =&gt; {
14     if (inputRef.current) {
15       inputRef.current.focus()
16     }
17   }, [])
18 
19   useEffect(() =&gt; {
20     let mounted = true
21 
22     const fetchData = async () =&gt; {
23       const response = await fetch(url)
24       const json = await response.json()
25 
26       if (mounted && json) {
27         if (!json.error) {
28           setItems(json.items)
29         }
30         else {
31           setError(json.error.message)
32         }
33 
34         setLoading(false)
35       }
36     }
37 
38     if (mounted && url) {
39       setLoading(true)
40       fetchData()
41     }
42 
43     return () =&gt; mounted = false
44   }, [url])
45 
46   const submitForm = e =&gt; {
47     e.preventDefault()
48     setUrl(prevUrl =&gt; query ? `${URL}/${query}` : '')
49   }
50 
51   return (
52     &lt;div&gt;
53       &lt;form onSubmit={submitForm}&gt;
54         &lt;label htmlFor='query-input'&gt;Search For &lt;/label&gt;
55         &lt;input
56           ref={inputRef}
57           type='text'
58           onChange={e =&gt; setQuery(e.target.value)} id='query-input'
59         /&gt;
60       &lt;/form&gt;
61 
62       &lt;div style={{marginTop: '20px'}}&gt;
63         {loading ? 'Loading...' :
64          error ? (&lt;div&gt;{error}&lt;/div&gt;) :
65          items &&
66           items.map(item =&gt;
67             &lt;div&gt;{item.volumeInfo.title}&lt;/div&gt;
68           )
69         }
70       &lt;/div&gt;
71     &lt;/div&gt;
72   )
73 })
74 
75 export default Solution;
      </pre>
    <p></p>
  </body> 
</html>

<p></p>

<h1>Conclusion</h1>

<p></p>
